var m=Object.defineProperty;var u=(r,e,t)=>e in r?m(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var s=(r,e,t)=>(u(r,typeof e!="symbol"?e+"":e,t),t);import{h as c}from"./index.d1d98574.js";import{T as p}from"./@toast-ui.1848f074.js";import{d as l,n as h,y as a,z as n,a as g,C as f,U as k,I as _}from"./@vue.d0b34203.js";import"./pinia.da056445.js";import"./vue-demi.b3a9cad9.js";import"./vue-router.fa6ba3ae.js";import"./lodash.535c3030.js";import"./dayjs.c7ebfd78.js";import"./element-plus.0e8a0458.js";import"./@element-plus.1c6bf0a0.js";import"./@ctrl.82a509e0.js";import"./@vueuse.12804d20.js";import"./lodash-es.f5e4b9c2.js";import"./axios.7aed06b8.js";import"./@icon-park.5afac6d7.js";/* empty css                    */import"./prosemirror-model.b56130c8.js";import"./orderedmap.3aa63af1.js";import"./prosemirror-view.005f3219.js";import"./prosemirror-state.334938da.js";import"./prosemirror-transform.ac9e639a.js";import"./prosemirror-keymap.d708e6c5.js";import"./w3c-keyname.74927781.js";import"./prosemirror-commands.85ed81c5.js";import"./prosemirror-inputrules.0752c43a.js";import"./prosemirror-history.a8db0b3f.js";import"./rope-sequence.7d68748c.js";function v(r){return c.request({url:"upload/image",method:"post",data:r})}class w{constructor(e,t,o){s(this,"editor");s(this,"isFullscreen",!1);this.height=o,this.editor=new p({el:document.querySelector(e),initialEditType:"markdown",previewStyle:"vertical",height:o,initialValue:t,toolbarItems:this.toolbar()}),this.ImageHook()}toolbar(){return[["heading","bold","italic","strike"],["hr","quote"],["ul","ol","task","indent","outdent"],["table","image","link"],["code","codeblock"],[{el:this.fullscreen(),command:"fullscreen",tooltip:"fullscreen"}]]}fullscreen(){const e=document.createElement("button");return e.innerHTML="\u5168\u5C4F",e.style.margin="0",e.addEventListener("click",()=>{this.toggleFullscreen()}),document.documentElement.addEventListener("keyup",t=>{t.key=="Escape"&&this.isFullscreen&&this.toggleFullscreen()}),e}toggleFullscreen(){document.querySelector(".toastui-editor-defaultUI").classList.toggle("fullscreen"),this.isFullscreen=!this.isFullscreen,this.isFullscreen===!1?this.editor.setHeight(this.height):this.editor.setHeight("100vh")}ImageHook(){this.editor.removeHook("addImageBlobHook"),this.editor.addHook("addImageBlobHook",async(e,t)=>{const o=new FormData;o.append("file",e,e.name);const i=await v(o);t(i.data.url,e.name)})}}const y={id:"markdownEditor"},E=l({props:{modelValue:{default:""},height:{default:500},placeholder:{default:""}},emits:["update:modelValue"],setup(r,{emit:e}){const t=r;return h(()=>{const o=new w("#markdownEditor",`${t.modelValue}`,`${t.height}px`);o.editor.on("change",i=>{e("update:modelValue",o.editor[i=="markdown"?"getMarkdown":"getHTML"]())})}),(o,i)=>(a(),n("div",y))}}),F={class:""},Y=l({setup(r){const e=g("abc");return(t,o)=>{const i=E;return a(),n("div",F,[f(i,{modelValue:e.value,"onUpdate:modelValue":o[0]||(o[0]=d=>e.value=d),height:300,placeholder:"\u8BF7\u8F93\u5165markdown\u5185\u5BB9"},null,8,["modelValue"]),k(" "+_(e.value),1)])}}});export{Y as default};
